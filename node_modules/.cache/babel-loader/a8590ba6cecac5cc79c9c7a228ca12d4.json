{"ast":null,"code":"import axios from 'axios';\nexport var login = function login(username, password) {\n  return function (dispatch, getState) {\n    var headers = {\n      \"Content-Type\": \"application/json\"\n    };\n    var body = JSON.stringify({\n      username: username,\n      password: password\n    });\n    return axios(\"http://127.0.0.1:2000/auth\", {\n      headers: {\n        'Access-Control-Allow-Origin': '*'\n      },\n      body: body,\n      method: \"POST\"\n    }).then(function (res) {\n      if (res.status < 500) {\n        console.log('there was an error:', res);\n        return {\n          status: res.status,\n          res: res\n        };\n      } else {\n        console.log(\"Server Error!\");\n        throw res;\n      }\n    }).then(function (res) {\n      if (res.status === 200) {\n        dispatch({\n          type: 'LOGIN_SUCCESSFUL',\n          data: res.data\n        });\n        return res.data;\n      } else if (res.status === 403 || res.status === 401) {\n        dispatch({\n          type: \"AUTHENTICATION_ERROR\",\n          data: res.data\n        });\n        throw res.data;\n      } else {\n        dispatch({\n          type: \"LOGIN_FAILED\",\n          data: res.data\n        });\n        throw res.data;\n      }\n    });\n  };\n};\nexport var loadUser = function loadUser() {\n  return function (dispatch, getState) {\n    dispatch({\n      type: \"USER_LOADING\"\n    });\n    var token = getState().auth.token;\n    var headers = {\n      \"Content-Type\": \"application/json\"\n    };\n\n    if (token) {\n      headers[\"Authorization\"] = \"Token \".concat(token);\n    }\n\n    return axios(\"http://127.0.0.1:2000\", {\n      headers: {\n        'Access-Control-Allow-Origin': '*'\n      }\n    }).then(function (res) {\n      if (res.status < 500) {\n        return {\n          status: res.status,\n          res: res\n        };\n      } else {\n        console.log(\"Server Error!\");\n        throw res;\n      }\n    }).then(function (res) {\n      if (res.status === 200) {\n        dispatch({\n          type: 'USER_LOADED',\n          user: res.data\n        });\n        return res.data;\n      } else if (res.status >= 400 && res.status < 500) {\n        dispatch({\n          type: \"AUTHENTICATION_ERROR\",\n          data: res.data\n        });\n        throw res.data;\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/Users/stephaniedoan/redux-login/src/actions/auth.js"],"names":["axios","login","username","password","dispatch","getState","headers","body","JSON","stringify","method","then","res","status","console","log","type","data","loadUser","token","auth","user"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\nexport const login = (username, password) => {\n  return (dispatch, getState) => {\n    let headers = {\"Content-Type\": \"application/json\"};\n    let body = JSON.stringify({username, password});\n\n    return axios(\"http://127.0.0.1:2000/auth\", {headers: { 'Access-Control-Allow-Origin': '*'}, body, method: \"POST\"})\n      .then(res => {\n        if (res.status < 500) {\n          console.log('there was an error:', res);\n            return {status: res.status, res};\n        } else {\n          console.log(\"Server Error!\");\n          throw res;\n        }\n      })\n      .then(res => {\n        if (res.status === 200) {\n          dispatch({type: 'LOGIN_SUCCESSFUL', data: res.data });\n          return res.data;\n        } else if (res.status === 403 || res.status === 401) {\n          dispatch({type: \"AUTHENTICATION_ERROR\", data: res.data});\n          throw res.data;\n        } else {\n          dispatch({type: \"LOGIN_FAILED\", data: res.data});\n          throw res.data;\n        }\n      })\n  }\n}\n\nexport const loadUser = () => {\n  return (dispatch, getState) => {\n    dispatch({type: \"USER_LOADING\"});\n\n    const token = getState().auth.token;\n\n    let headers = {\n      \"Content-Type\": \"application/json\",\n    };\n\n    if (token) {\n      headers[\"Authorization\"] = `Token ${token}`;\n    }\n    return axios(\"http://127.0.0.1:2000\", {headers: { 'Access-Control-Allow-Origin': '*'}, })\n      .then(res => {\n        if (res.status < 500) {\n          return {status: res.status, res};\n        } else {\n          console.log(\"Server Error!\");\n          throw res;\n        }\n      })\n      .then(res => {\n        if (res.status === 200) {\n          dispatch({type: 'USER_LOADED', user: res.data });\n          return res.data;\n        } else if (res.status >= 400 && res.status < 500) {\n          dispatch({type: \"AUTHENTICATION_ERROR\", data: res.data});\n          throw res.data;\n        }\n      })\n  }\n}"]},"metadata":{},"sourceType":"module"}